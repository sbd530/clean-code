# 3장 함수

## 작게 만들어라

함수를 만드는 첫째 규칙은 '작게!'다. 둘째 규칙은 '더 작게!'다.

그럼 얼마나 짧으면 좋을까? 아래 정도가 적당하다.

```java
public static String renderPageWithSetupsAndTeardowns(PageData pageData, boolean isSuite) throws Exception {
    if (isTestPage(pageData))
      includeSetupAndTeardownPages(pageData isSuite);
    return pageData.getHtml();
}
```

### 블록과 들여쓰기

`if...else`, `while` 문 블록 안의 코드는 한 줄이어야 한다. 그러면 현재 함수 코드가 작아짐과 동시에, 블록 속 호출되는 함수의 이름을 적절히 지어 가독성을 높일 수 있다.

함수에서 들여쓰기 레벨은 2단을 넘어서면 이해하기 어려워 진다.

## 한 가지만 해라

함수는 한 가지를 해야 한다. 그 한가지를 잘 해야 한다. 그 한 가지만을 해야 한다.

## 함수 당 추상화 수준은 하나로!

한 함수 내에 추상화 수준을 섞으면 코드를 읽는 사람이 헷갈린다. 표현이 근본 개념인지 세부사항인지 알 수 없기 때문이다.

## 위에서 아래로 코드 읽기 : 내려가기 규칙

위에서 아래로 프로그램을 읽으면 함수 추상화 수준이 한번에 한단계 씩 낮아진다.(내려가기 규칙)

> 설정 페이지와 해제 페이지를 포함하려면, 설정 페이지를 포함하고, 테스트 페이지 내용을 포함하고, 해제 페이지를 포함한다.
>
> > 설정 페이지를 포함하려면, 슈트이면 슈트 설정페이지를 포함한 후 일반 설정 페이지를 포함한다.
> > 슈트 설정 페이지를 포함하려면, ...

이런식으로 위에서 아래로 문단을 읽어내려 가듯 코드를 구현하면 추상화 수준을 일관되게 유지하기가 쉬워진다.

## Switch 문

스위치 문은 작게 만들기 어렵다. 또한 한가지 작업만 하는 스위치문도 만들기 어렵다.

추상 팩토리 등으로 스위치 문을 꽁꽁 숨겨서 사용하는 방법도 있다.

## 서술적인 이름을 사용하라!

> 코드를 읽으면서 짐작했던 기능을 각 루틴이 그대로 수행한다면 깨끗한 코드라 불러도 되겠다

이름이 길어도 좋다. 길고 서술적인 이름이 짧고 어려운 이름, 길고 서술적인 주석보다 좋다.

이름을 정하는데 시간을 들여도 괜찮다. IDE로 이름을 리팩터링하는 것은 쉽다. 이것저것 시도해보자.

서술적인 이름은 개발자가 코드 흐름을 이해하는 것을 도우며, 곧 유지보수를 돕는다.

## 함수 인수

이상적인 인수 개수는 0개다. 3개 이상은 피하자.

### 플래그 인수

불리언을 인수로 넘기는 것은 함수가 한번에 여러 가지를 처리한다고 공표하는 셈이다. 플래그 인수는 쓰지말자.

### 이항 함수

인수가 2개인 함수가 1개인 함수보다 이해하기 어렵다. `writeField(name)`는 `writeField(outputStream, name)`보다 이해하기 쉽다.

인수가 2개가 넘어가면 인수 객체나 가변 인수 등을 고려해보자.

## 명령과 조회를 분리하라!

함수는 수행하거나 답하거나 둘 중 하나만 해야한다. 객체 정보를 변경하거나, 객체 정보를 반환하거나 둘 중 하나다.

## 오류 코드보다 예외를 사용하라!

자칫하면 함수가 표현식으로 사용되어질 수 있다.

```java
if (deleteSometing(id) == E_OK ) {}
```

try/catch 로 예외를 사용하면 코드가 깔끔해진다.

또한 블록 내부 코드를 내부 추출하여 보기 쉽게 만들 수 있다.

## 함수를 어떻게 짜죠?

처음에는 길고 복잡하다. 이름은 즉흥적이고 코드는 중복된다. 그다음 그 코드를 빠짐없이 테스트하는 단위 테스트 케이스를 만든다.

그 다음 코드를 다듬고 단위테스트를 돌린다.
